% --- [ MC-Semantics Example ] -------------------------------------------------

\subsection{MC-Semantics Example}
\label{app:mc-semantics_example}

As described in section \ref{sec:rel_work_mc-semantics}, MC-Semantics consists of two components which collectively decompile native code into LLVM IR. To demonstrate the capabilities of MC-Semantics, the relocatable object code of a simple C program (see listing \ref{lst:example1_c}) was analysed. For reference, the disassembly of the relocatable object code is presented in listing \ref{lst:example1_asm}. Firstly, the control flow recovery component parsed the relocatable object code (i.e. ELF file) and disassembled its machine instructions (i.e. x86 assembly) to produce a serialized CFG (in the Google Protocol Buffer format), an extract of which is presented in listing \ref{lst:example1_pb_cfg}. Secondly, the instruction translation component converts the native instruction of the serialized CFG into semantically equivalent, unoptimized LLVM IR; the listing of which was omitted for the sake of brevity. Lastly, the optimizer of the LLVM compiler framework analyses the unoptimized LLVM IR to produce an optimized version, which is presented in listing \ref{lst:example1_ll}.

\lstinputlisting[language=nasm, style=nasm, caption={Disassembly of the relocatable object code which was produced from the C source code presented in listing \ref{lst:example1_c}. \label{lst:example1_asm}}]{inc/appendices/mcsema_example/example1.asm}

\lstinputlisting[language=C, style=c, caption={An extract of the textual representation of a serialized CFG (in Google Protocol Buffer format), which was generated by the control flow recovery component of MC-Semantics when analysing the relocatable object code which contained the disassembly presented in listing \ref{lst:example1_asm}. \label{lst:example1_pb_cfg}}]{inc/appendices/mcsema_example/example1_cfg_extract.txt}

\lstinputlisting[language=llvm, style=nasm, caption={Decompiled LLVM IR, which was produced by MC-Semantics when analysing the relocatable object code which contained the disassembly presented in listing \ref{lst:example1_asm}. \label{lst:example1_mcsema_ll}}]{inc/appendices/mcsema_example/example1.ll}
