% --- [ Type Inference ] -------------------------------------------------------

\subsection{Type Inference}

% ~~~ [ Value-based type inference ] ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\paragraph{Value-based type inference} The type of a variable may be inferred from the values used in its operations (e.g. assignment, comparison, arithmetic). For instance, a variable assigned the value \texttt{321} may be classified as a signed or unsigned integer of bit size at least 16 (since the value \texttt{321} does not fit in 8 bits). More concretely, the \texttt{mov} instruction in \texttt{f} at line \texttt{14} (see figure \ref{fig:running_example_asm} in appendix \ref{app:running_example}).

This corresponds to \textit{num16} and \textit{num32} in the primitive type lattice of a 32-bit system (see figure \ref{fig:base_type_lattice}).

%the values assigned to it. \todo{TODO: describe value-based type inference. E.g. if value is \texttt{42}, infer that it is an integer, if value is \texttt{0x401005} infer that it is a pointer. Bring up problems with this approach, misclassification.} \cite{type_inference_on_executables}

% ~~~ [ Flow-based type inference ] ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\paragraph{Flow-based type inference}

\todo{TODO: describe type inference, Algorithm W} \cite{milner_algorithmw}

% ~~~ [ Instruction type sources ] ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\paragraph{Instruction type sources}

Also known as type revealing instruction.

\todo{TODO: describe type revealing instructions. Infer from the instruction that the operand is of integer type, memory, floating-point, etc.}

% ~~~ [ Function type sources ] ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\paragraph{Function type sources}

Type information derived for arguments in calls to functions with known functions signatures (e.g. those of the standard library). \cite{type_inference_on_executables}

% ~~~ [ Type sink ] ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\paragraph{Type sink}

A type sink is a type which can be resolved directly and is known to be correct. For instance, types for arguments inferred from function type sources.

% ~~~ [ Format-string based type inference ] ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\paragraph{Format-string based type inference}

\todo{TODO: describe format-string based type inference.}

Type of arguments to \texttt{printf} call may be inferred by format-string verbs (e.g. \texttt{\%d}).

\todo{TODO: use example of eax register in NASM example above to illustrate the need to track life ranges}.
